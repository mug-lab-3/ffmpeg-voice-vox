# System Behavior Specification

本ソフトウェアのシステム全体の動作仕様、自動監視、および生成ファイルの管理について記載します。

## 1. 動作環境・要件
- **OS**: Windows 10/11 (推奨)
- **Runtime**: Python 3.10以降
- **依存サービス**:
    - **Voicevox**: ローカルホスト (`127.0.0.1`) のポート `50021` で稼働している必要があります。

## 2. 自動監視・シャットダウン (Watchdog)

リソースの節約を目的として、無操作時の自動終了機能を備えています。

- **仕組み**: 最後のアクティビティ（APIリクエスト、音声合成処理等）からの経過時間を監視します。
- **タイムアウト**: **300秒 (5分)**
- **挙動**: 5分間アクセスがない場合、プロセスを安全に終了します。
- **実装箇所**: `voicevox_controller.py` 内の `monitor_activity` スレッド。

## 3. 生成ファイル仕様

音声合成が行われると、設定された出力ディレクトリ（デフォルトは `val_output/` 等）に以下のファイルが生成されます。

### 3.1 ファイル命名規則
`{開始時間(ms)}_{話者名}_{テキスト先頭8文字}.{拡張子}`
- 例: `001500_ずんだもん_こんにちは.wav`

### 3.2 構成内容
1.  **WAVファイル**: Voicevoxによって生成された音声データ。
2.  **SRTファイル**: 字幕データ。開始時刻は `00:00:00,000` 固定、終了時刻は音声の長さに合わせて自動設定されます。

## 4. ログ・監視
- **アプリケーションログ**: `logs/app.log` に出力されます。
- **ログの構成**: 動作ログ、設定の同期情報、およびエラー時のスタックトレースが記録されます。
- **ローテーション**: ファイルサイズが1MBを超えると自動的にリネームされ、最大10世代まで保持されます。
